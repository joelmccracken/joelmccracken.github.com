<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Emacs Lisp for Hackers: Keys, and Keymaps</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Nebby about Tech">
    <link rel="canonical" href="http://joelmccracken.github.io/entries/emacs-lisp-for-hackers-keys/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">
</head>


    <body>

        <header class="site-header">
  <div class="wrap">
    <a class="site-title" href="/">Joel's Journal</a>
  </div>
</header>


        <div class="page-content">
            <div class="wrap">
                <div class="post">
                    <header class="post-header">
                        <h1>Emacs Lisp for Hackers: Keys, and Keymaps</h1>
                        <p class="meta">Dec 10, 2012</p>
                    </header>

                    <article class="post-content">
                        <h1 id="the-keyboard-keys-and-keymaps">The Keyboard: Keys and Keymaps</h1>

<p>Its been a while since I posted in this series – but don’t fret! I
sill am dedicated to providing a guide to Emacs Lisp, the guide that I
wish I had a year ago. I also recently
implied that I prefer Ruby to Lisp, but that is not
important. Emacs is still the best developer environment in the world,
and occupies a really important place in the future of code composition.</p>

<div class="sidebar">
<p>
<h4>Afraid to change keybindings?</h4>
</p>
<p>
To be honest, I was always a little uneasy about altering the default Emacs
keybindings. I felt that if I overrode them, I would somehow miss out
on something. 
</p>
<p>
I found that my fears unfounded. I should have just jumped in on my
first day, customizing whatever I felt like. I have yet to encounter a
problem because of some key bindings I had previous overridden. So, if you feel some
trepidation about changing keybindings, you should go ahead and try.</p>
</div>

<p>The learning to program in Emacs Lisp can be split into a number of
concerns. The first concern is the language itself. How do we initialize
variables, create functions, generally structure programs? So far, we have
been mostly limited to these types of concerns. We have not yet
touched on manipulating Emacs itself. Which, is basically the goal of
all of this Emacs hacking, right? So, to get started, lets look at
manipulating keybindings. One of Emacs’ most “famous” features is the
magic you can do with the keyboard. I use quotes around famous because
the finger stretching it requires is the primary source of criticism.</p>

<p>Either way, keybindings are a good place to start talking about
modifying Emacs.</p>

<h2 id="setting-a-global-keyboard-binding">Setting a Global Keyboard Binding</h2>

<p>On Mac OS X Emacs, the key Command-Q will kill Emacs. I always hated
this. Disabling it was really easy, though:</p>

<pre><code>(global-set-key (kbd "s-q") nil)
</code></pre>

<p>This code introduces a few things. First, we use the <code>global-set-key</code>
function, which sets the key, well, globally. Other commands set keys
for specific keymaps. Which we’ll get to in a minute.</p>

<p>Next, we have the form <code>kbd</code>. We could skip using <code>kbd</code>, but the
strings we would need to use to specify a key binding would be uglier
and more opaque. Using <code>kbd</code> lets us specify these in a much more
consistent, natural way. In the above example, “s-q” is the
“Command-Q” binding.</p>

<p>Finally, we have <code>nil</code>. This means that the key binding now does
nothing, which disables the Command-Q quitting in our personal Emacs. Nice!</p>

<p>We can bind functions to keys. Lets create a binding so that Meta-h
will execute a “hello world” function:</p>

<pre><code>(global-set-key (kbd "M-h")
                (lambda ()
                  (interactive)
                  (message "Hello from Emacs!")))
</code></pre>

<p>Now, if you press Meta-h, you’ll receive a friendly greeting from
Emacs.</p>

<p>This is the essence of keybindings. If you were to stop reading here,
you would be able to get pretty far. However, there is another feature
that we should discuss: that is, keymaps.</p>

<h2 id="keymaps">Keymaps</h2>

<p>A keymap is simply a collection of keys to bindings. They allow us to
conveniently group bindings to be collectively added, enabled, or
disabled.</p>

<p>Not only does a keymap hold keybindings, it can also itself be bound
to a key. In this way, we create a hierarchy of bindings. Lets look at
a quick example:</p>

<pre><code>(defvar joel-custom-keymap nil "my keymap..")

(setq joel-custom-keymap (make-sparse-keymap))
(global-set-key (kbd "C-x M-j")  joel-custom-keymap)

(define-key joel-custom-keymap (kbd "s") 'otto/status)
(define-key joel-custom-keymap (kbd "t") 'twit)
(define-key joel-custom-keymap (kbd "p") 'plan)
</code></pre>

<p>This is actual code that I use. It comes straight out of my dotemacs
file. It binds the keymap <code>joel-custom-keymap</code> to the key sequence 
“C-x M-j”. When I press those, I can then press <code>s</code>, <code>t</code>, or <code>p</code> to
run the commands <code>otto/status</code>, <code>twit</code>, or <code>plan</code>, respectively.</p>

<p>I feel like this is straightforward but awkward to explain. In any
case, this is enough to get started. You’ll probably want to
get familiar with what 
<a href="http://www.gnu.org/software/emacs/manual/html_node/elisp/Keymaps.html">the manual entry</a>
contains so that you will know where to look in the future. Happy hacking!</p>

                    </article>

                    <div id="disqus_thread"></div>
                    <script>
                     var disqus_shortname = 'joelmccracken'; // required: replace example with your forum shortname

                     var disqus_config = function () {
                         this.page.url = "http://joelmccracken.github.io/entries/emacs-lisp-for-hackers-keys/";
                         this.page.identifier = "/entries/emacs-lisp-for-hackers-keys";
                         this.page.title = "Emacs Lisp for Hackers: Keys, and Keymaps";
                     };

                     (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
                         var d = document, s = d.createElement('script');

                         s.src = '//'+disqus_shortname+'.disqus.com/embed.js';  // IMPORTANT: Replace EXAMPLE with your forum shortname!
                         s.setAttribute('data-timestamp', +new Date());
                         (d.head || d.body).appendChild(s);
                     })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>
            </div>
        </div>

        <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">Joel McCracken</h2>

    <div class="footer-col-1 column">
      <ul>
        <li><a href="mailto:mccracken.joel@gmail.com">mccracken.joel@gmail.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/JoelMcCracken">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">JoelMcCracken</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/JoelMcCracken">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">JoelMcCracken</span>
          </a>
        </li>
      </ul>
    </div>

    <!-- 
    <div class="footer-col-3 column">
      <p class="text">would like to add some rotating content down here</p>
    </div>
    -->
  </div>

</footer>


        <script type="text/javascript">
 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-7759066-1']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();
</script>

    </body>
</html>
